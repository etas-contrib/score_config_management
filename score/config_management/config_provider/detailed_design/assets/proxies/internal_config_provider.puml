@startuml

!startsub IInternalConfigProvider
abstract class IInternalConfigProvider {
    + {abstract} GetParameterSet(\n\
    set_name : const score::cpp::string_view,\n\
    timeout : const std::chrono::milliseconds) : Result<json::Any>
    + {abstract} TrySubscribeToLastUpdatedParameterSetEvent(\n\
    stop_token : const score::cpp::stop_token&,\n\
    callback : OnChangedParameterSetCallback&&) : bool
    + {abstract} GetInitialQualifierState(timeout : const std::chrono::milliseconds) : InitialQualifierState
    + {abstract} StartParameterSetUpdatePollingRoutine(\n\
    max_samples_limit : score::cpp::optional<std::size_t>,\n\
    polling_cycle_interval : score::cpp::optional<std::chrono::milliseconds>) : void
    + {abstract} StopParameterSetUpdatePollingRoutine() : void
    + {abstract} CheckParameterSetUpdates() : void
    --
    Responsibilities: This class wraps communication with external service InternalConfigProvider
}       
!endsub

!startsub InternalConfigProvider
class InternalConfigProvider {
    + InternalConfigProvider(proxy : std::unique_ptr<AdaptiveProxy>)
    + GetParameterSet(\n\
    set_name : const score::cpp::string_view,\n\
    timeout : const std::chrono::milliseconds) : Result<json::Any>
    + TrySubscribeToLastUpdatedParameterSetEvent(\n\
    stop_token : const score::cpp::stop_token&,\n\
    callback : OnChangedParameterSetCallback&&) : bool
    + GetInitialQualifierState(timeout : const std::chrono::milliseconds) : InitialQualifierState
    + StartParameterSetUpdatePollingRoutine(\n\
    max_samples_limit : score::cpp::optional<std::size_t>,\n\
    polling_cycle_interval : score::cpp::optional<std::chrono::milliseconds>) : void
    + StopParameterSetUpdatePollingRoutine() : void
    + CheckParameterSetUpdates() : void
    --
    - logger_ : mw::log::Logger&
    - proxy_ : std::unique_ptr<AdaptiveProxy>
    - on_changed_parameter_set_callback_ : OnChangedParameterSetCallback
    - is_available_notification_callback_ : IsAvailableNotificationCallback
    - max_samples_limit_ : std::size_t
    - polling_cycle_interval_ : std::chrono::milliseconds
    - polling_routine_cv_ : concurrency::InterruptibleConditionalVariable
    - last_updated_parameter_set_names_ : score::cpp::pmr::unordered_set<std::string>
    - mutex_ : mutable std::mutex
    - polling_thread_ : score::cpp::optional<score::cpp::jthread>
}

IInternalConfigProvider <|-- InternalConfigProvider

!endsub

@enduml
